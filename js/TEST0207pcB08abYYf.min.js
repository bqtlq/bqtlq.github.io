var app=new Vue({el:"#main",data:{myStatus:0,myJsFile:"",show_index:0,showType:0,is_display:!0,isRegisterShow:!1,isLoginShow:!1,isLoginModalShow:!1,isModelSiteShow:!1,isBackModelShow:!1,isEditSiteShow:!1,isAddSiteShow:!1,isEditCatShow:!1,isRayChecked:!0,is_edit:0,url_len:0,cNn:12,siteLists:[],catLists:[],hLs:[],hCaLs:[],themeLists:[],myThemeIndex:-3,selThemeIndex:-3,dragDom:null,targetDom:null,sIdx:-1,sIdx1:-1,tIdx:-1,tIdx1:-1,mUL:[],ddL:[],aL:[],mL:[],myEdSite:{id:0,name:"",url:"",old_name:"",old_url:"",index:-1,index1:-1},myAddSite:{name:"",url:"",index:-1},newID:1e3,myEditCat:{cid:0,name:"",old_name:"",index:-1},mCaL:[],testColor:"#ffffff",catColor:"#919191",hoverLiIndex:-1,wbHots:[],zhHots:[],bdHots:[],isHotShow:!1,hotSWTitle:"",netThm:{id:-2,type:0,url:"",name:"",color:"#111111",color1:"#111111",ray:"#F5F5F5",op:1},iceflag:!1},created:function(){this.getList(),this.gtDfThm(),this.gtCurOpt(),this.themeLists=fTs},mounted:function(){this.testColor=colBlend("#919191","#ffffff",.3),this.hotSWTitle="打开热榜"},methods:{changeListStyle:function(t){return this.hoverLiIndex!==t?"":{"box-shadow":"1px 1px 3px "+this.catColor,"border-radius":"10px"}},changeCatStyle:function(t){return t?{"border-bottom":"2px solid "+this.catColor}:""},switchHotSpot:function(){this.isHotShow=!this.isHotShow,this.isHotShow?this.hotSWTitle="关闭热榜":this.hotSWTitle="打开热榜"},getHotBang:function(t){},togLay:function(){2===this.showType?this.showType=0:this.showType=this.showType+1,localStorage.setItem("layType",this.showType),0===isG&&this.$http.post("/index/ajax_tog_lay",{laytype:this.showType,domysub:1},{emulateJSON:!0}).then(function(t){},function(t){alert(t.status)})},itemHover:function(t){this.hoverLiIndex=t},delItemHover:function(t){this.hoverLiIndex=-1},cancelLogin:function(){this.isLoginModalShow=!1,this.isLoginShow=!1,slideVerify.resetVerify()},showLogin:function(){this.isLoginModalShow=!0,this.isLoginShow=!0,this.isRegisterShow=!1},showFgt:function(){this.isLoginShow=!1,openForm(8)},backLogin:function(){clearFgtInfo(),closeForm(8),this.isLoginShow=!0},cancelReset:function(){clearFgtInfo(),clearResetInfo(),closeForm(9),this.isLoginModalShow=!1,this.isRegisterShow=!1},showModelSite:function(){0!==isG?(this.myUserName="",this.myPWD="",this.myCode="",openForm(1),openForm(2),closeForm(3)):(this.mL=undefined,this.mL=[],this.aL=undefined,this.aL=[],this.ddL=undefined,this.ddL=[],this.mUL=undefined,this.mUL=[],this.mCaL=undefined,this.mCaL=[],this.isModelSiteShow=!0,this.iceflag=!1)},toggleMode:function(t){this.isRegisterShow=!this.isRegisterShow},openEditCatForm:function(t){var s=this.hCaLs[t];this.myEditCat.cid=s.cid,this.myEditCat.old_name=s.catname,this.myEditCat.name=s.catname,this.myEditCat.index=t;t=$(document).scrollTop()+200;$(".edit-cat-panel").css({"margin-top":t+"px"}),this.isEditCatShow=!0},closeEditCatForm:function(){this.isEditCatShow=!1},postEditCat:function(){if(this.myEditCat.name===this.myEditCat.old_name)return this.isEditCatShow=!1,0;var t=this.myEditCat.index,s=this.hCaLs[t];this.hCaLs[t].catname=this.myEditCat.name,this.mCaL.push({cid:this.myEditCat.cid,name:this.myEditCat.name,type:s.tmptype,ishide:s.ishide}),this.isEditCatShow=!1},swHide:function(t){0===this.hCaLs[t].ishide?this.hCaLs[t].ishide=1:this.hCaLs[t].ishide=0},shrinkSon:function(t){this.hCaLs[t].exp=0},expandSon:function(t){this.hCaLs[t].exp=1},sortU:function(t){if(1<t&&!this.iceflag){this.iceflag=!0;var s=t;for(let t=0;t<this.hLs[s].sites.length;t++)this.hLs[s].sites[t].tmptype=s-1;for(let t=0;t<this.hLs[s-1].sites.length;t++)this.hLs[s-1].sites[t].tmptype=s;this.hCaLs[s].tmptype=s-1,this.hCaLs[s-1].tmptype=s;var i=this.hCaLs[t-1];this.$set(this.hCaLs,t-1,this.hCaLs[t]),this.$set(this.hCaLs,t,i);i=this.hLs[t-1];this.$set(this.hLs,t-1,this.hLs[t]),this.$set(this.hLs,t,i),this.iceflag=!1}},sortD:function(t){if(t<this.hCaLs.length-1&&!this.iceflag){this.iceflag=!0;var s=t;for(let t=0;t<this.hLs[s].sites.length;t++)this.hLs[s].sites[t].tmptype=s+1;for(let t=0;t<this.hLs[s+1].sites.length;t++)this.hLs[s+1].sites[t].tmptype=s;this.hCaLs[s].tmptype=s+1,this.hCaLs[s+1].tmptype=s;var i=this.hCaLs[t+1];this.$set(this.hCaLs,t+1,this.hCaLs[t]),this.$set(this.hCaLs,t,i);i=this.hLs[t+1];this.$set(this.hLs,t+1,this.hLs[t]),this.$set(this.hLs,t,i),this.iceflag=!1}},closeModelSite:function(){this.isModelSiteShow=!1,location.reload()},saveModelSite:function(){this.mL=undefined,this.mL=[];for(let s=0;s<this.mCaL.length;s++)for(let t=0;t<this.hCaLs.length;t++)if(this.mCaL[s].cid===this.hCaLs[t].cid){this.mCaL[s].type=this.hCaLs[t].tmptype,this.mCaL[s].ishide=this.hCaLs[t].ishide;break}for(let s=0;s<this.hCaLs.length;s++){for(let t=0;t<this.hLs[s].sites.length;t++){var i=this.hLs[s].sites[t];if(999===Number(i.order)){for(let t=0;t<this.aL.length;t++)if(i.id===this.aL[t].id){this.aL[t].tmptype=i.tmptype,this.aL[t].tmporder=i.tmporder,this.aL[t].cid=this.hCaLs[s].cid;break}}else Number(i.type)===Number(i.tmptype)&&Number(i.order)===Number(i.tmporder)||this.mL.push({id:i.id,tmptype:i.tmptype,tmporder:i.tmporder})}var e=this.hCaLs[s];if(Number(e.type)!==Number(e.tmptype)||Number(e.ishide)!==Number(e.ohide)){let s=0;for(let t=0;t<this.mCaL.length;t++)if(this.mCaL[t].cid===e.cid){this.mCaL[t].type=e.tmptype,this.mCaL[t].ishide=e.ishide,s=1;break}0===s&&this.mCaL.push({cid:e.cid,name:e.catname,type:e.tmptype,ishide:e.ishide})}}var t=this;this.$http.post("/index/ajax_abc",{modcats:t.mCaL,aaas:t.aL,mods:t.mL,modurls:t.mUL,ddls:t.ddL,dosubmit:1},{emulateJSON:!0}).then(function(t){1<=t.data.rid||alert("保存失败！建议退出后重新登录！"),this.isModelSiteShow=!1,location.reload()},function(t){alert(t.status),location.reload()})},closeAddSiteForm:function(){this.isAddSiteShow=!1},addSite:function(t){this.myAddSite.url="",this.myAddSite.name="",this.myAddSite.index=t;t=$(document).scrollTop()+200;$(".edit-site-panel").css({"margin-top":t+"px"}),this.isAddSiteShow=!0},postAddUrl:function(){let i=this;this.$http.post("index/ajax_get_post",{url:i.myAddSite.url,name:i.myAddSite.name},{emulateJSON:!0}).then(function(t){var s;1<=t.data.rid&&(this.newID++,s={id:this.newID,type:i.myAddSite.index,order:999,title:i.myAddSite.name,isedit:Number(t.data.isedit),logo:t.data.logo1,url:i.myAddSite.url,tmptype:i.myAddSite.index,tmporder:i.hLs[i.myAddSite.index].sites.length,turl:i.myAddSite.url,murl:"",mo:1,omo:1},i.hLs[i.myAddSite.index].sites.push(s),this.aL.push({id:this.newID,order:999,name:i.myAddSite.name,isedit:Number(t.data.isedit),logo:t.data.logo,url:i.myAddSite.url,tmptype:i.myAddSite.index,tmporder:i.hLs[i.myAddSite.index].sites.length,cid:0}),i.isAddSiteShow=!1)},function(t){alert(t.status)})},editUrl:function(t,s,i,e,h){this.myEdSite.url=s,this.myEdSite.name=i,this.myEdSite.old_url=s,this.myEdSite.old_name=i,this.myEdSite.id=t,this.myEdSite.index=e,this.myEdSite.index1=h;h=$(document).scrollTop()+200;$(".edit-site-panel").css({"margin-top":h+"px"}),this.isEditSiteShow=!0},postEditUrl:function(){if(this.myEdSite.old_url!==this.myEdSite.url||this.myEdSite.old_name!==this.myEdSite.name){let e=this;this.$http.post("index/ajax_get_post",{url:e.myEdSite.url,name:e.myEdSite.name},{emulateJSON:!0}).then(function(s){var t=Number(s.data.rid);let i=e.hLs[e.myEdSite.index].sites[e.myEdSite.index1];if(1<=t){i.title=e.myEdSite.name,i.url=e.myEdSite.url,i.logo=s.data.logo1;t=i.order;if(999===Number(t)){for(let t=0;t<this.aL.length;t++)if(this.aL[t].id===e.myEdSite.id){this.aL[t].name=e.myEdSite.name,this.aL[t].url=e.myEdSite.url,this.aL[t].isedit=Number(s.data.isedit),this.aL[t].logo=s.data.logo1;break}}else this.mUL.push({id:e.myEdSite.id,name:e.myEdSite.name,url:e.myEdSite.url,isedit:Number(s.data.isedit),logo:s.data.logo});e.isEditSiteShow=!1}},function(t){alert(t.status)})}else this.isEditSiteShow=!1},removeUrl:function(t,s,i,e){var h=Number(s.id),o=this.hLs[this.cNn-1].sites;if(30<=o.length||i===this.cNn-1){if(999===Number(s.order)){for(let t=0;t<this.aL.length;t++)if(this.aL[t].id===h){this.aL.splice(t,1);break}}else{for(let t=0;t<this.mUL.length;t++)if(Number(this.mUL[t].id)===h){this.mUL.splice(t,1);break}this.ddL.push({id:h})}this.hLs[i].sites.splice(e,1);for(let t=e;t<this.hLs[i].sites.length;t++)this.hLs[i].sites[t].tmporder=t}else{s=this.cNn-1,o=o.length;this.hLs[s].sites.splice(o,0,this.hLs[i].sites[e]),this.hLs[i].sites.splice(e,1),this.hLs[s].sites[o].tmptype=s,this.hLs[s].sites[o].tmporder=o;for(let t=e;t<this.hLs[i].sites.length;t++)this.hLs[i].sites[t].tmporder=t}},closeEditSiteForm:function(){this.isEditSiteShow=!1},dropSite:function(t){t.stopPropagation(),t.preventDefault()},dragSiteStart:function(t,s,i){t.dataTransfer.effectAllowed="move",this.dragDom=t.currentTarget,this.sIdx=s,this.sIdx1=i,t.currentTarget.style.opacity=.4;i=t.currentTarget.getBoundingClientRect();t.dataTransfer.setDragImage(this.dragDom,t.x-i.left,t.y-i.top)},dragSiteEnter:function(t,s,i){this.tIdx=s,this.tIdx1=i},dragSiteEnd:function(t){if(this.tIdx<=-1||-1===this.tIdx1||this.tIdx1<-2)t.currentTarget.style.opacity=1;else{if(this.sIdx===this.tIdx){if(0<=this.tIdx1)if(this.tIdx1<this.sIdx1){this.hLs[this.tIdx].sites.splice(this.tIdx1,0,this.hLs[this.sIdx].sites[this.sIdx1]),this.hLs[this.tIdx].sites.splice(Number(this.sIdx1)+1,1);for(let t=this.tIdx1;t<=this.sIdx1;t++)this.hLs[this.tIdx].sites[t].tmporder=t}else if(this.tIdx1>this.sIdx1){this.hLs[this.tIdx].sites.splice(this.tIdx1+1,0,this.hLs[this.sIdx].sites[this.sIdx1]),this.hLs[this.tIdx].sites.splice(this.sIdx1,1);for(let t=this.sIdx1;t<=this.tIdx1;t++)this.hLs[this.tIdx].sites[t].tmporder=t}}else if(0<=this.tIdx1){if(1===Number(this.hLs[this.sIdx].sites[this.sIdx1].isedit)&&this.hLs[this.tIdx].sites.length<30){this.hLs[this.tIdx].sites.splice(this.tIdx1,0,this.hLs[this.sIdx].sites[this.sIdx1]),this.hLs[this.sIdx].sites.splice(this.sIdx1,1),this.hLs[this.tIdx].sites[this.tIdx1].tmptype=this.tIdx;for(let t=this.tIdx1;t<this.hLs[this.tIdx].sites.length;t++)this.hLs[this.tIdx].sites[t].tmporder=t;for(let t=this.sIdx1;t<this.hLs[this.sIdx].sites.length;t++)this.hLs[this.sIdx].sites[t].tmporder=t}}else if(-2===this.tIdx1&&1===Number(this.hLs[this.sIdx].sites[this.sIdx1].isedit)){var s=this.hLs[this.tIdx].sites.length;if(s<30){this.hLs[this.tIdx].sites.splice(s,0,this.hLs[this.sIdx].sites[this.sIdx1]),this.hLs[this.sIdx].sites.splice(this.sIdx1,1),this.hLs[this.tIdx].sites[s].tmptype=this.tIdx,this.hLs[this.tIdx].sites[s].tmporder=s;for(let t=this.sIdx1;t<this.hLs[this.sIdx].sites.length;t++)this.hLs[this.sIdx].sites[t].tmporder=t}}t.currentTarget.style.opacity=1,this.dragDom=null,this.targetDom=null,this.sIdx=-1,this.sIdx1=-1,this.tIdx=-1,this.tIdx1=-1,t.preventDefault()}},dragOverSite:function(t,s,i){t.preventDefault()},gtCurOpt:function(){var t;0===isG?(localStorage.setItem("showOpts",JSON.stringify(uconfs)),localStorage.setItem("layType",uconfs.laytype),this.showType=uconfs.laytype):(t=localStorage.getItem("layType"),this.showType=null!=t?Number(t):0)},gtDfThm:function(){if(0===isG)this.myThemeIndex=meTheme.id,this.stBg(meTheme),localStorage.setItem("pcTheme",JSON.stringify(meTheme)),localStorage.setItem("netTheme",JSON.stringify(netTheme)),this.netThm=netTheme,this.isRayChecked=11===this.netThm.type;else if(0<localStorage.length){let t=JSON.parse(localStorage.getItem("pcTheme"));null==t&&(t=moTheme);var s=JSON.parse(localStorage.getItem("netTheme"));null!=s&&(this.netThm=s),this.isRayChecked=11===this.netThm.type;s=t.id;this.myThemeIndex=t.id,0<s?this.stBg(t):0===s?this.stBg(moTheme):-1===s?this.stBg(ranTheme):-2===s&&this.stBg(this.netThm)}else this.myThemeIndex=0,this.isRayChecked=11===this.netThm.type,this.stBg(moTheme)},stBg:function(t){var s=t.url,i=t.color,e=t.color1,h=t.ray;document.body.style.backgroundImage="url("+s+")";e=colBlend(e,cur_h_color,cur_ratio);$(".siteList").find("a").css("color",i),$(".itemCat").css("color",e),$(".chroItems").find("a").css("color",i),$(".squaItems").find("a").css("color",i),11===t.type?setTShadow(h,1):setTShadow(h,0),this.catColor=e},getList:function(){let s=this,t;0===isG?(t=pJpara,localStorage.setItem("jsFile",t)):(t=localStorage.getItem("jsFile"),null!=t&&""!==t||(t=pAcust));var i="/get_s_list/"+t;this.$http.get(i).then(function(t){s.catLists=t.data.cats,s.siteLists=t.data.data,s.hCaLs=t.data.cats,s.hLs=t.data.data,s.cNn=s.hCaLs.length})},showModelTheme:function(){if(this.selThemeIndex=this.myThemeIndex,this.netThm.id){let t=this.netThm.color,s=this.netThm.color1,i=this.netThm.ray;$("#text-color").val(t.substring(1)),$("#cat-color").val(s.substring(1)),$("#ray-color").val(i.substring(1)),$("#net-pic-url").val(this.netThm.url)}this.isBackModelShow=!0},saveTheme:function(){if(this.myThemeIndex!==this.selThemeIndex||-2===this.selThemeIndex){this.myThemeIndex=this.selThemeIndex;let s={id:0,type:0,name:"",url:"",color:"",color1:"",ray:""};if(0<this.myThemeIndex){let t=getThmId(this.myThemeIndex);t=0<=t?t:0,s=this.themeLists[t]}else{var t;0===this.myThemeIndex?(s.id=0,s.name="默认背景"):-1===this.myThemeIndex?(s.id=-1,s.name="随机背景"):-2===this.myThemeIndex&&(s.id=-2,s.type=this.isRayChecked?11:0,s.name="网络背景",t=$("#net-pic-url").val(),checkPicUrl(t)&&validPicUrl(t)?s.url=t:s.url="",s.color="#"+$("#text-color").val(),s.color1="#"+$("#cat-color").val(),s.ray="#"+$("#ray-color").val(),s.op=1,this.netThm=s,localStorage.setItem("netTheme",JSON.stringify(s)))}localStorage.setItem("pcTheme",JSON.stringify(s)),0===isG&&(-2===this.myThemeIndex?this.$http.post("/index/ajax_save_thm_net",{thm:s,domysub:1},{emulateJSON:!0}).then(function(t){t.data.rid},function(t){alert(t.status)}):this.$http.post("/index/ajax_save_thm",{tid:s.id,domysub:1},{emulateJSON:!0}).then(function(t){t.data.rid},function(t){alert(t.status)})),this.isBackModelShow=!1}else this.isBackModelShow=!1},closeTheme:function(){var t;this.selThemeIndex!==this.myThemeIndex&&(0<this.myThemeIndex?0<=(t=getThmId(this.myThemeIndex))?this.stBg(this.themeLists[t]):null==(t=JSON.parse(localStorage.getItem("pcTheme")))?this.stBg(this.themeLists[1]):this.stBg(t):0===this.myThemeIndex?this.stBg(moTheme):-1===this.myThemeIndex?this.stBg(ranTheme):-2===this.myThemeIndex&&this.stBg(this.netThm)),this.isBackModelShow=!1},selectTheme:function(t,s){var i;0<(this.selThemeIndex=t)?0<=(i=getThmId(t))?this.stBg(this.themeLists[i]):this.stBg(this.themeLists[1]):0===t?this.stBg(moTheme):-1===t?this.stBg(ranTheme):-2===t&&this.stBg(this.netThm)},setTextColor:function(t){var s;-2==this.selThemeIndex&&(0===t?(s="#"+$("#text-color").val(),checkIsColor(s)&&($(".siteList").find("a").css("color",s),$(".chroItems").find("a").css("color",s))):1===t?(t="#"+$("#cat-color").val(),checkIsColor(t)&&(t=colBlend(t,cur_h_color,cur_ratio),$(".itemCat").css("color",t),this.catColor=t)):this.setRay())},stNetBg:function(){var t,s;-2==this.selThemeIndex&&(s=$("#net-pic-url").val(),checkPicUrl(s)&&validPicUrl(s)&&(document.body.style.backgroundImage="url("+s+")",t="#"+$("#text-color").val(),s="#"+$("#cat-color").val(),$("#ray-color").val(),$(".siteList").find("a").css("color",t),$(".chroItems").find("a").css("color",t),s=colBlend(s,cur_h_color,cur_ratio),$(".itemCat").css("color",s),this.setRay(),this.catColor=s))},setRay:function(){var t="#"+$("#ray-color").val();this.isRayChecked?checkIsColor(t)&&setTShadow(t,1):setTShadow(t,0)},checkRay:function(){this.isRayChecked=!this.isRayChecked,this.setRay()},switchShowIndex:function(t){let s=this;clearTimeout(curOutTime),curOutTime=setTimeout(function(){s.show_index=t},300)},cancelSwi:function(){clearTimeout(curOutTime)}}});
